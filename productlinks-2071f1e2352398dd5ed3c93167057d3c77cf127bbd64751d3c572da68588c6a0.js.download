"use strict";P.when("A").register("ac-tab-controller",function(t){var e=t.$,a=function(t){var a=t.data,n=e(t.$target),r=n.closest(".ac-tab");e("li",r).removeClass("active");var i=n.closest("li");i.addClass("active");var o=e(".ac-tab-content",n.closest(".ac-tab-container"));o.each(function(t,n){var r=e(n);r.data("type")===a.type?r.show():r.hide()})},n=function(t){var n=t.prefix,r=t.type,i=e("#"+n+"-"+r+"-header");a({$target:i,data:{type:r}})};t.declarative("ac-tab-switch","click",a),t.on("ac-tab-change",n)}),P.when("A","a-popover","ac-utils","ac-widget-utils","ac-string-utils","a-checkbox","ready").register("ac-dropdown",function(t,e,a,n,r,i){var o=t.$,s="ac-dropdown-",c=s+"popover-",l=function(t,e){null===t&&(t=n.getWidgetContainer(s,e));var a=t.find("#"+s+e.name);return a},d=function(t,e){var a=t.find("#"+s+"display"+e.name);return a},u=function(t){var e=n.getWidgetContainer(s,t),a=d(e,t);a.text(t.label);var r=l(e,t);r.val(t.value);var i=n.getOptionsContainer(s,t);o("li.ac-widget-dropdown-option-single-selected",i).removeClass("ac-widget-dropdown-option-single-selected");var c=o('li.ac-widget-dropdown-option-single[data-value="'+t.value+'"]',i);c.addClass("ac-widget-dropdown-option-single-selected")},p=function(t){var e=n.getWidgetContainer(s,t),a=l(e,t);return a.val()},h=function(t,e,a){var n=[],r=s+"checkbox-"+a.name+"-all",i=null;return"ALL"===e?i=".a-checkbox":"EXCLUDE"===e?i=".a-checkbox[data-a-input-name!="+r+"]":"ONLY"===e&&(i=".a-checkbox[data-a-input-name="+r+"]"),i&&(n=t.find(i)),n},f=function(t){var e=t.find("input[type=checkbox]");return e},g=function(t){var e=t.find(".a-checkbox-label");return e},m=function(t){return o('.ac-widget-dropdown-options-search input[type="text"]',t)},v=function(t){return o(".ac-widget-dropdown-options-search",t).data("ajax-search-enabled")},b=function(t){return o(".ac-widget-dropdown-options-search",t).data("ajax-search-url")},M=function(t){return o(".ac-widget-dropdown-options-search",t).data("ajax-custom-data")},y=function(t){return o(".ac-widget-dropdown-options-search",t).data("is-multi-select")},_=function(t){return o(".ac-widget-dropdown-options-search",t).data("custom-multi-select-label")},L=function(t){return o(".ac-widget-dropdown-options-search",t).data("multi-select-limit")},A=function(t){return o(".ac-widget-dropdown-options-search",t).data("multi-select-limit-error")},w=function(t){return o(".ac-widget-dropdown-options",t)},T=function(t){return o(".ac-widget-dropdown-option-single-loader",t)},k=function(t){return e.get("ac-dropdown-popover-"+t.name)},C=function(t){var e=t.data;n.hideOptionsContainer(s,e.name),u(e),S(e,e.value,e.label)},z=function(t){var e,a,r=t.data,c=t.$target,l=i(c).isChecked(),d=n.getOptionsContainer(s,r),u=h(d,"EXCLUDE",r),p=u.length;if("all"===r.value)u.find("input").prop("checked",l);else{var f=!1,g=L(d);if(g&&u.find("input:checked").length>parseInt(g))return c.prop("checked",!1),K(d),void x(d,r,!1);for(e=0;p>e;e++){var m=o(u[e]);if(a=i(m).isChecked(),!a){f=!0;break}}x(d,r,!f)}J(d)},x=function(t,e,a){var n=h(t,"ONLY",e);n.find("input").prop("checked",a)},S=function(e,a,r){var i={},o=!1,c=n.getOptionsContainer(s,e),l=m(c),d=y(c);if(d){var u=_(c);o=r===u||r.split(",").length>1}i[e.arg_name]=a,i[e.arg_name+"_label"]=r,i._isMultiSelect=d,i._searchText=l.length?l.val().trim():"",i._multipleValues=o;var p=n.getEventName(e.name,"change");t.trigger(p,i)},D=function(t){var e=n.getOptionsContainer(s,t);if(Q(e,t))return void K(e);var a=O(t),r=a[0],i=a[1];n.hideOptionsContainer(s,t.name),S(t,r,i)},O=function(t){var e=n.getOptionsContainer(s,t),a="",c="",l=h(e,"ALL",t),d=l.length;if(d>0)for(var p=0;d>p;p++){var m=o(l[p]),v=i(m).isChecked();if(v){var b=f(m),M=g(m);if("all"===b.val()){a=b.val(),c=M.text().trim();break}""===a?(a=b.val(),c=M.text().trim()):(a=a+","+b.val(),c=c+", "+M.text().trim())}}else{a=t.value;var y=o("li.ac-widget-dropdown-option-single[data-value="+a+"]",e);c=y.text()?y.text().trim():""}""===a&&(a="all",c=r.getString("widget-all"));var L=_(e);return c.split(",").length>1&&L&&(c=L),u({name:t.name,value:a,label:c}),[a,c]},N=function(t){n.hideOptionsContainer(s,t.name)},E=function(t,e){var a=o("li.ac-widget-dropdown-option-single",t);o.each(a,function(t,a){var n=o(a);e?n.data("label").toLowerCase().indexOf(e)>-1?n.removeClass("ac-hidden"):n.addClass("ac-hidden"):n.removeClass("ac-hidden")})},q=function(e){var a=e.data,r=n.getOptionsContainer(s,a);v(r)?e.$event.keyCode===t.constants.keycodes.ENTER&&R(a):Y(a)},P=function(t){R(t.data)},R=function(t,e){var r=n.getOptionsContainer(s,t),i=m(r).val(),c={url:b(r),data:{prefix:i,all_selection:i&&y(r)?!1:t.all_selection}};o.extend(c.data,M(r));var l={showMask:!1},d={data:t,postSuccessCallback:e};a.ajax(c,F,W,d,l),w(r).empty(),T().show(),k(t).updatePosition()},F=function(t,e,a,n){var r=n.data,i=k(r);B(r,t),T().hide(),i&&i.updatePosition(),n.postSuccessCallback&&n.postSuccessCallback.call()},W=function(t,e,a,n){T().hide()},B=function(t,e){var a=n.getOptionsContainer(s,t),r=w(a),i=y(a),o=s+"checkbox-"+t.name+"-",c="";if(e&&e.length)for(var l=0;l<e.length;l++){var d=e[l];c+=i?'<li><span class="a-declarative" data-action="ac-widget-dropdown-select-multi" data-ac-widget-dropdown-select-multi="{&quot;value&quot;:&quot;'+d[t.value_attr]+"&quot;,&quot;label&quot;:&quot;"+d[t.label_attr]+"&quot;,&quot;name&quot;:&quot;"+t.name+'&quot;}"><div data-a-input-name="'+o+("All"===d[t.value_attr]?"all":d[t.value_attr])+'" class="a-checkbox a-checkbox-fancy"><label><input type="checkbox" name="'+o+d[t.value_attr]+'" value="'+d[t.value_attr]+'"><i class="a-icon a-icon-checkbox a-icon-checkbox-inactive"></i><span class="a-label a-checkbox-label">'+d[t.label_attr]+"</span></label></div></span></li>":'<span class="a-declarative" data-action="ac-widget-dropdown-select-single" data-ac-widget-dropdown-select-single="{&quot;value&quot;:&quot;'+d[t.value_attr]+"&quot;,&quot;label&quot;:&quot;"+d[t.label_attr]+"&quot;,&quot;name&quot;:&quot;"+t.name+"&quot;,&quot;arg_name&quot;:&quot;"+t.arg_name+'&quot;}"><li class="ac-widget-dropdown-option-single"data-label="'+d[t.label_attr]+'" data-value="'+d[t.value_attr]+'">'+d[t.label_attr]+"</li></span>"}r.empty().append(c)},Y=function(t){var e=n.getOptionsContainer(s,t),a=m(e).val();a?(a=a.toLowerCase(),X(t)):j(t),E(e,a)},I=function(t){var e=t.data,a=n.getOptionsContainer(s,e);n.getWidgetContainer(s,e);E(a,""),m(a).val(""),j(e)},X=function(t){var e=n.getOptionsContainer(s,t);o(".ac-widget-dropdown-options-search .a-icon-close",e).removeClass("ac-hidden")},j=function(t){var e=n.getOptionsContainer(s,t);o(".ac-widget-dropdown-options-search .a-icon-close",e).addClass("ac-hidden")},H=function(t){var e=n.getWidgetContainer(s,t),a=n.getOptionsContainer(s,t),r=l(e,t),i=r.val();$(t,i),E(a,""),j(t),v(a)||m(a).val("")},$=function(t,e){if(e)for(var a=n.getOptionsContainer(s,t),r=(e+"").split(","),i=h(a,"ALL",t),c=i.length,l=0;c>l;l++){var d=o(i[l]),u=f(d),p=u.val(),g=!1;"all"===e?g=!0:r.indexOf(p)>-1&&(g=!0),d.find("input").prop("checked",g)}},U=function(t){var e=t.data;"ok"===e.action?D(e):"cancel"===e.action&&N(e)},V=function(t){if(r.startsWith(t.popover.name,c)){o(t.popover.$container).addClass("ac-widget-popover").addClass("ac-widget-dropdown-popover");var e={name:t.popover.name.replace(c,"")};H(e)}},G=function(){J()},K=function(t){A(t)&&o(".ac-widget-dropdown-select-error",t).show().delay(2e3).fadeOut()},Q=function(t,e){var a=i(h(t,"ONLY",e)),n=h(t,"EXCLUDE",e),r=n.find("input:checked").length,o=L(t),s=o&&r>parseInt(o);return a?a.isUnchecked()&&s:s},J=function(t){o(".ac-widget-dropdown-select-error",t).hide()};t.declarative("ac-widget-dropdown-select-single","click",C),t.declarative("ac-widget-dropdown-select-multi","change",z),t.declarative("ac-widget-dropdown-select-action","click",U),t.declarative("ac-widget-dropdown-search","keyup",q),t.declarative("ac-widget-dropdown-search-btn","click",P),t.declarative("ac-widget-dropdown-search-clear","click",I),t.on("a:popover:afterShow",V),t.on("a:popover:afterHide",G);var Z=function(t,e){var a=null;if(t&&e){var n={name:t+"-"+e};a=p(n)}return a},tt=function(t,e,a,r){var i=!1;if(t&&e&&a){var o={name:t+"-"+e,value:a};if(r&&r._isMultiSelect&&r._searchText&&r._triggerData){var c=n.getOptionsContainer(s,o);m(c).val(r._searchText),R(r._triggerData,function(){$(o,a),O(o)})}else $(o,a),O(o);i=!0}return i};return{getValue:Z,setValue:tt}}),P.when("A").register("ac-manage-tracking",function(t){var e=t.$,a=["store_id"],n='<input type="hidden" name="{{name}}" value="{{value}}">',r=e("#ac-app-main-manage-tracking-form"),i=function(t){e("#tracking_id").val(t.tracking_id),r.submit()},o=function(e){var i=e.data;if(!t.objectIsEmpty(i))for(var o in i)if(i.hasOwnProperty(o)&&-1===t.indexOfArray(a,o)){var s=r.find("input[name="+o+"]");if(s.length)s.val(i[o]);else{var c=n.replace("{{name}}",o).replace("{{value}}",i[o]);r.append(c)}}};t.on("ac-historychange",o),t.on("ac-app-tracking_id-change",i)}),P.when("A","ac-selection-utils","ac-short-url").register("ac-ads-code-container",function(t,e,a){var n=t.$,r={init:function(){this.initEvents()},initEvents:function(){t.declarative("ac-ad-code-container-click","click",n.proxy(this.handleContainerClick,r)),t.declarative("ac-ad-code-button-click","click",n.proxy(this.selectCode,r)),t.declarative("ac-ad-code-format-change","change",n.proxy(this.toggleFormat,r)),t.on("ac-ad-code-update",n.proxy(this.updateAdCode,r))},selectCode:function(t){var a=t.$target.closest(".ac-ad-code-container-wrapper").find(".ac-ad-code-area:visible").get(0);a.focus(),e.copyText(a)},toggleFormat:function(t){var e=t.$target.closest(".ac-ad-code-container-wrapper");e.find(".ac-ad-code-area").hide(),e.find(".ac-ad-code-area[data-action-type="+t.$target.val()+"]").show()},handleContainerClick:function(t){t.$target.is("textarea")&&this.selectCode(t)},updateAdCode:function(t){if(t&&t.id&&t.content){n("#"+t.id)?n("#"+t.id).find(".ac-ad-code-area").val(t.content):"";var e=n("#"+t.id+" .ac-ad-code-link"),a=n("#"+t.id+" .ac-ad-code-short");if(e.length){var r=null,i="GetShortUrl|WidgetHelper|Count";n.ajax({async:!0,data:{instance:i},cache:!1,dataType:"json",url:"/home/productlinks/shortUrlMetric",success:function(t){r=t}});var o=this.getLinkFromAdcode(t.content);e.val(o),a.val(""),this.getShortURLFromAdcodeLink({target:a,link:o})}}},getLinkFromAdcode:function(t){var e=[];return e=t.match(/href="([^"]+)"/),e.length&&e[1]?e[1]:""},getShortURLFromAdcodeLink:function(t){var e=n.proxy(this.handleShortUrlSuccess,r),i=n.proxy(this.handleShortUrlFailure,r),o={successCb:e,errorCb:i,longurl:t.link,target:t.target};a.getShortUrl(o)},handleShortUrlSuccess:function(t,e,a,n){t.isOk&&n.target.val(t.shortUrl)},handleShortUrlFailure:function(){}};r.init()}),P.when("A","a-carousel-framework","ready").register("ac-carousel",function(t,e){function a(t){var e=L[t];e&&(e.isMouseOverOn=!0)}function n(t){var e=L[t];e&&(e.isMouseOverOn=!1)}function r(t){var e=t.getAttr("name"),a=L[e];return a?a:{}}function i(t){var t=t.selectedButton.$button.find(".a-button-input").data(),e=g(t),a=r(e);a.autoRotateInterval=clearInterval(a.autoRotateInterval),e.gotoPage(t.page+1)}function o(t){var e=r(t.carousel);e.navRef.find(".a-button").removeClass("a-button-selected").eq(t.newValue-1).addClass("a-button-selected")}function s(e){var a=r(e);clearInterval(a.autoRotateInterval),a.autoRotateInterval=t.interval(function(){u(e.dom.$carousel)&&e.gotoNextPage()},e.getAttr("interval")||3e3)}function c(t,e){var a=e||t.getAttr("name");clearInterval(L[a].autoRotateInterval),L[a].autoRotateInterval=null}function l(t){var e=r(t);e.autoRotateInterval||s(t)}function d(e){var a=e.getAttr("name"),n=r(e),i=n.navRef.find(".a-button");s(e),t.on("a:carousel:"+a+":change:pageNumber",o),e.dom.$carousel.delegate(".a-carousel-card","mouseover",function(t){c(e)}),e.dom.$carousel.delegate(".a-carousel-card","mouseout",function(t){l(e)}),i&&i.removeClass("a-button-selected").eq(0).addClass("a-button-selected"),L[a].initialized=!0}function u(t){var e=p(t).offset().top,a=e+p(t).outerHeight(),n=p(window).scrollTop(),r=n+p(window).height();return a>n&&r>e}var p=t.$,h="ac-carousel-nav-action-disabled",f=function(t){return p("#ac-carousel-"+t.name)},g=function(t){var a=null,n=f(t);return n.length>0&&(a=e.getCarousel(n.children()[0])),a},m=function(t,e,a){var n=f(t),r=p(".ac-carousel-nav-"+e,n);a?r.removeClass(h):r.addClass(h)},v=function(t,e){var a=t.getAttr("pageNumber");t.getAttr("totalPages");(a>1||L[t.getAttr("name")].autoRotate)&&(c(t),t.gotoPrevPage(),m(e,"next",!0)),2>=a&&m(e,"prev",!1)},b=function(t,e){var a=t.getAttr("pageNumber"),n=t.getAttr("totalPages");(n>a||L[t.getAttr("name")].autoRotate)&&(c(t),t.gotoNextPage(),m(e,"prev",!0)),a===n-1&&m(e,"next",!1)},M={prev:v,next:b},y=function(t){var e=t.data,a=g(e);if(a){var n=M[e.type];n&&"function"==typeof n&&n.call(this,a,e)}},_=function(){e.createAll(),e.initializeAll();var t=p(".ac-carousel");p.each(t,function(t,a){var n=p(a),r=e.getCarousel(n.children()[0]);if(r){var i=r.getAttr("name");L[i]=n.data(),L[i].navRef=n.find(".ac-carousel-circular-nav");var o={name:i};L[i].autoRotate&&!L[i].initialized&&d(r);var s=r.getAttr("pageNumber"),c=r.getAttr("totalPages");1===c&&m(o,"next",!1),1===s&&m(o,"prev",!1)}})},L={};return t.declarative("ac-widget-carousel-action","click",y),t.on("a:button-group:ac-carousel-circular-nav:toggle",i),_(),{initializeAll:_,getCarousel:g,pauseCarousel:a,playCarousel:n}}),P.when("A","a-modal","ac-short-url","ac-app-config","ac-link-id","ac-utils").register("ac-quicklink-ad-text-link-modal",function(t,e,a,n,r,i){var o=t.$,s={urlObject:{},linkcode:null,currentLinkId:null,popoverInstance:null,adsCodeContainer:null,linkIdParams:{},toggleEventParams:null,toggle:!0,init:function(){this.initEvents()},initEvents:function(){t.declarative("ac-quicklink-ad-textlink-modal-trigger","click",o.proxy(this.openTextlinkModal,s)),t.declarative("ac-quicklink-ad-textlink-modal-get-short-url","click",o.proxy(this.toggleAdTextlinkUrl,s)),t.on("a:popover:ajaxSuccess:ac-quicklink-ad-textlink-modal",o.proxy(this.onPopoverDataLoad,s)),t.on("ac-app-tracking-id-selector-change",o.proxy(this.handleTrackingIdChange,s))},handleTrackingIdChange:function(t){this.toggleEventParams&&!this.toggle&&this.toggleAdTextlinkUrl(this.toggleEventParams),this.setLinkId(this.popoverInstance,t["tracking-id-selector"])},onPopoverDataLoad:function(t){var e=this;setTimeout(function(){e.popoverInstance=t.popover,e.setLinkId(t.popover),e.toggleEventParams=null,e.toggle=!0},0)},setLinkId:function(t,e){var a=n.getConfig("Associates.LinkCode");this.adsCodeContainer=t.$container.find("textarea");var s=this.adsCodeContainer.val();e&&(s=s.replace(this.linkIdParams.tag,e));var c={toolCreation:a.tool,tag:e||i.getTrackingId()};c.destinationUrl&&(c.destinationUrl=c.destinationUrl.replace("&linkId={{link_id}}","")),c=o.extend(this.linkIdParams,c);var l=r.get(c,{});e&&(s=s.replace(this.currentLinkId,l)),this.currentLinkId=l,this.adsCodeContainer.val(s.replace(/{{link_id}}/g,this.currentLinkId))},toggleAdTextlinkUrl:function(e){var a=e.data,n=this.urlObject[this.linkIdParams.tag];this.toggleEventParams={$target:e.$target,data:e.data},t.objectIsEmpty(n)?this.getShortUrl(e):this.toggle?(this.toggle=!1,e.$target.text(a.shortenText),o("#ac-quicklink-ad-textlink textarea").val(n.shortUrl)):(this.toggle=!0,e.$target.text(a.text),o("#ac-quicklink-ad-textlink textarea").val(n.longUrl))},getShortUrl:function(t){var e=o.proxy(this.handleShortUrlSuccess,s),n=o.proxy(this.handleShortUrlFailure,s),r={successCb:e,errorCb:n,longurl:this.adsCodeContainer.val(),eventInfo:t};a.getShortUrl(r)},openTextlinkModal:function(t){this.urlObject={};var a=t.data,n=t.$target,r=e.create(n,a);this.linkIdParams=t.data.link_id_params,r.show()},handleShortUrlSuccess:function(t,e,a,n){this.urlObject[this.linkIdParams.tag]=t,this.toggleAdTextlinkUrl(n.eventInfo)},handleShortUrlFailure:function(){}};s.init()}),P.when("A","ac-quicklink-search-interface").register("ac-quicklink-browse-product",function(t,e){var a=t.$,n={init:function(){this.initVariable(),this.initEvents()},initVariable:function(){this.searchResultContainer=a("#ac-quicklink-browse-product-result"),this.mainContainer=a("#ac-produclinks-quicklink-tabs-container"),this.browseProductUrl=this.searchResultContainer.data("url"),this.params={}},initEvents:function(){this.mainContainer.delegate(".category-item-link","click",a.proxy(this.handleCategorySelection,n))},getParameters:function(t){var e={};return e.data=a(t.target).data("itemInfo"),e.url=this.browseProductUrl,e},handleCategorySelection:function(t){var e=this.getParameters(t);this.params=e,this.getSearchResults()},getSearchResults:function(){var t=a.proxy(this.handleSearchSuccess,n),r=a.proxy(this.handleSearchFailure,n),i={succesCb:t,errorCb:r,isLazyLoad:!0,append:!1,ajaxOptions:n.params,searchResultContainerId:"ac-quicklink-browse-product-result"};e.loadSearchresult(i)},scrollToview:function(){var t=this.mainContainer.offset();a("html, body").animate({scrollTop:t.top,scrollLeft:t.left})},handleSearchSuccess:function(t,e,n,r){r.append||this.scrollToview(),t.categoryinfo&&(a("#ac-quicklink-browse-category-list").html(this.createCategoryTree(t)),a("#ac-quicklink-browse-selected-category").html(a(t.categoryinfo).find("#ac-quicklink-browse-selected-category").html()))},handleSearchFailure:function(t,e,a,n){},createCategoryTree:function(t){var e=a(t.categoryinfo),n=e.find(".ancestors li"),r=e.find(".self li"),i=e.find(".childs"),o="";return a.each(n,function(t,e){o+="<ul>",o+=a("<div>").html(e).html()}),r.length&&(o+="<ul>",o+=a("<div>").html(r.first()).html()),i.length&&(o+=i.html()),r.length&&(o+="</ul>"),a.each(n,function(t,e){o+="</ul>"}),a(o)}};n.init()}),P.when("A","a-modal","ac-app-config","ac-link-id","ac-utils","ac-ads-code-container","ac-string-utils").register("ac-promohub-ad-code-modal",function(t,e,a,n,r,i,o){var s=t.$,c={init:function(){this.initEvents(),this.initVariables()},initVariables:function(){var t=s("#ac-promohub-link-ad-code-template");this.adCodeTemplate=t.val(),this.adcodeModal=s("#ac-promohub-link-ad-code-modal"),this.trackingId=t.data("tagId")},initEvents:function(){t.declarative("ac-promohub-get-ad-code-action","click",s.proxy(this.getAdCodeModal,c)),t.on("a:popover:ajaxSuccess:ac-promohub-get-adcode-modal",s.proxy(this.onPopoverDataLoad,c)),t.on("ac-common-show-promo-adcode-modal",s.proxy(this.showAdCodeModal,c))},onPopoverDataLoad:function(t){var e=this;setTimeout(function(){e.setLinkId(t.popover)},0)},getLinkId:function(t,e){t=t||{};var i=a.getConfig("Associates.LinkCode"),o={tag:r.getStoreId(),toolCreation:i.tool};if(e&&(o.adUnitScriptType="iframe"===e?"iFrame":"JS"),o=s.extend(t,o),o.destinationUrl){var c=decodeURIComponent(o.destinationUrl);o.destinationUrl=c.replace("&linkId={{link_id}}","")}return n.get(o,{})},setLinkId:function(t){var e=this;this.adsCodeContainer=t.$container.find("textarea");var a=t.$container.find(".banner-ad-code-area").data("link_id_params");this.adsCodeContainer.each(function(t,n){var r=s(n),i=r.val();r.val(i.replace(/{{link_id}}/g,e.getLinkId(a,r.data("actionType"))))})},getAdCodeModal:function(t){var a,n=t.data;"link"===n.type?(a=this.adcodeModal,this.updateAdcode(t.$target)):a=t.$target;var r=e.create(a,n);r.show()},getFilledTemplate:function(t,e){for(var a in t)if(t[a]){var n=t[a];"retailUrl"===a&&(n=decodeURIComponent(n)),e=e.replace("{{"+a+"}}",n)}return e},updateAdcode:function(e){var a=e.closest(".promo-item-display").find(".ac-promohub-get-link-ad-code-data").data(),n=this.getFilledTemplate(a,this.adCodeTemplate);n=n.replace(/{{link_id}}/g,this.getLinkId(a.linkIdParams)),n=n.replace(/{{link_code}}/g,a.linkCode),s("#ac-promohub-link-ad-code-preview").html(n),t.trigger("ac-ad-code-update",{content:n,id:"ac-promohub-link-ad-code-container"})},showAdCodeModal:function(a){if(a.hasOwnProperty("adData")){var n=this.adcodeModal,r={header:o.getString("promohub-get-link-title"),name:"ac-promohub-link-adcode-modal",width:"65%",type:"link"},i=s.extend(!0,r,a.modalData),c=a.adData,l=this.getFilledTemplate(c,this.adCodeTemplate),d=e.create(n,i);l=l.replace(/{{link_id}}/g,this.getLinkId(c.linkIdParams)),l=l.replace(/{{link_code}}/g,c.linkCode),l=l.replace(/{{tracking_id}}/g,this.trackingId),s("#ac-promohub-link-ad-code-preview").html(l),t.trigger("ac-ad-code-update",{content:l,id:"ac-promohub-link-ad-code-container"}),d.show()}}};c.init()}),P.when("A","ac-utils","ac-app-config").register("ac-quicklink-search-interface",function(t,e,a){var n=t.$,r={metadata:{},scrollPrecision:.7,loadSearchresult:function(t){var i=this.getCurrentModuleMetaData(t);if(!i.requestInProgress){i.requestInProgress=!0;var o=i.ajaxOptions,s={url:o.url,data:o.data,timeout:a.getConfig("ajax_timeout")},c={showMask:i.append?!1:!0},l=n.proxy(this.handleSearchSuccess,r),d=n.proxy(this.handleSearchFailure,r);if(i.append&&(i.searchResultContainer.find(".search-result-loader").show(),!i.hasNextPage))return i.searchResultContainer.find(".search-result-loader").hide(),!1;if(i.requestInProgress){var u=i;e.ajax(s,l,d,u,c)}}},getCurrentModuleMetaData:function(t){if(void 0===typeof t.searchResultContainerId)throw"Mandatory parameter 'searchResultContainerId' is missing";this.metadata[t.searchResultContainerId]=t;var e=this.metadata[t.searchResultContainerId];return e.searchResultContainer=n("#"+t.searchResultContainerId),e.ajaxOptions=this.getParameters(t.ajaxOptions),e},getParameters:function(t){return t},handleSearchSuccess:function(t,a,i,o){var s=this.metadata[o.searchResultContainerId];s.requestInProgress=!1,s.isLazyLoad&&(s.append?(s.searchResultContainer.find(".search-result-loader").hide(),s.searchResultContainer.find(".search-result-body-wrapper").append(n(t.search_result).find(".search-result-item"))):(s.searchResultContainer.empty().append(t.search_result),s.scrollOnWIndow||s.searchResultContainer.find(".search-result-body").unbind("scroll").bind("scroll",e.debounce(n.proxy(r.handleLazyLoad,this),50)),s.searchResultContainer.data("dataid",s.searchResultContainerId))),s.hasNextPage=t.metadata?t.metadata.has_next_page:!1,s.searchResultContainer.find(".search-result-loader").hide(),"function"==typeof s.succesCb&&s.succesCb.apply(this,arguments)},handleSearchFailure:function(t,e,a,n){"function"==typeof n.errorCb&&n.errorCb.apply(this,arguments)},loadMoreResults:function(t,e){var a=e||t.closest(".search-result").data("dataid"),n=this.metadata[a];n&&(n.requestInProgress||(n.append=!0,n.ajaxOptions.data.page=n.ajaxOptions.data.page?n.ajaxOptions.data.page+1:2,this.loadSearchresult(n)))},isLazyLoad:function(t){var e=t?t.target:n(window);return e.scrollTop/(e.scrollHeight-e.offsetHeight)>this.scrollPrecision?!0:!1},handleLazyLoad:function(t){var e=t.target;this.isLazyLoad(t)&&this.loadMoreResults(n(e))}};return{loadSearchresult:n.proxy(r.loadSearchresult,r),loadMoreResults:n.proxy(r.loadMoreResults,r)}}),P.when("A","ac-quicklink-search-interface","ac-utils").register("ac-quicklink-search-product",function(t,e,a){var n=t.$,r={init:function(){this.initVariable(),this.initEvents()},initVariable:function(){this.searchField=n("#ac-quicklink-search-product-field"),this.searchResultContainer=n("#ac-quicklink-search-product-result"),this.mainContainer=n("#ac-produclinks-quicklink-tabs-container"),this.params={}},initEvents:function(){t.declarative("ac-quicklink-search-product-btn","click",n.proxy(this.handleSearchAction,r))},getParameters:function(t){var e=t.data;return e.data={},e.data.keywords=a.escapeHtml(this.searchField.val()),e},handleSearchAction:function(t){t.$event.preventDefault(),this.params=this.getParameters(t),this.searchField.blur(),this.loadSearchResults()},loadSearchResults:function(){var t=n.proxy(this.handleSearchSuccess,r),a=n.proxy(this.handleSearchFailure,r),i={succesCb:t,errorCb:a,isLazyLoad:!0,append:!1,ajaxOptions:r.params,searchResultContainerId:"ac-quicklink-search-product-result"};e.loadSearchresult(i)},scrollToview:function(){var t=this.mainContainer.offset();n("html, body").animate({scrollTop:t.top,scrollLeft:t.left})},handleSearchSuccess:function(t,e,a,n){n.append||this.scrollToview()},handleSearchFailure:function(t,e,a,n){}};r.init()}),P.when("A","ac-carousel","ac-app-config","ac-utils","ready").register("ac-topsellers",function(t,e,a,n){var r=t.$,i={getTopSellers:function(t){if(!t)throw"Required data object with mandatory URL is not passed";var e={url:t.url,data:t.params,timeout:a.getConfig("ajax_timeout")},o={showMask:!0},s=t,c=r.proxy(this.loadTopSellers,i),l=r.proxy(this.handleError,i);n.ajax(e,c,l,s,o)},loadTopSellers:function(t,a,n,r){r.container&&(r.container.html(t.carousel_template),e.initializeAll()),"function"==typeof r.successCb&&r.successCb.apply(this,arguments)},handleError:function(t,e,a,n){"function"==typeof n.errorCb&&n.errorCb.apply(this,arguments)}};return{loadTopSellers:r.proxy(i.getTopSellers,i)}}),/*! 
 * jQuery MiniColors: A tiny color picker built on jQuery
 * Contribute: https://github.com/claviska/jquery-minicolors
 * @license: http://opensource.org/licenses/MIT
 */
P.when("A").register("3p-jquery-minicolors",function(t){var e=$;!function(t){t(e)}(function(t){function e(e,a){var n,r,i,o,s,l=t('<div class="minicolors" />'),d=t.minicolors.defaults;if(!e.data("minicolors-initialized")){if(a=t.extend(!0,{},d,a),l.addClass("minicolors-theme-"+a.theme).toggleClass("minicolors-with-opacity",a.opacity).toggleClass("minicolors-no-data-uris",a.dataUris!==!0),void 0!==a.position&&t.each(a.position.split(" "),function(){l.addClass("minicolors-position-"+this)}),n="rgb"===a.format?a.opacity?"25":"20":a.keywords?"11":"7",e.addClass("minicolors-input").data("minicolors-initialized",!1).data("minicolors-settings",a).prop("size",n).wrap(l).after('<div class="minicolors-panel minicolors-slider-'+a.control+'"><div class="minicolors-slider minicolors-sprite"><div class="minicolors-picker"></div></div><div class="minicolors-opacity-slider minicolors-sprite"><div class="minicolors-picker"></div></div><div class="minicolors-grid minicolors-sprite"><div class="minicolors-grid-inner"></div><div class="minicolors-picker"><div></div></div></div></div>'),a.inline||(e.after('<span class="minicolors-swatch minicolors-sprite minicolors-input-swatch"><span class="minicolors-swatch-color"></span></span>'),e.next(".minicolors-input-swatch").on("click",function(t){t.preventDefault(),e.focus()})),o=e.parent().find(".minicolors-panel"),o.on("selectstart",function(){return!1}).end(),a.swatches&&0!==a.swatches.length)for(a.swatches.length>7&&(a.swatches.length=7),o.addClass("minicolors-with-swatches"),r=t('<ul class="minicolors-swatches"></ul>').appendTo(o),s=0;s<a.swatches.length;++s)i=a.swatches[s],i=v(i)?f(i,!0):T(h(i,!0)),t('<li class="minicolors-swatch minicolors-sprite"><span class="minicolors-swatch-color"></span></li>').appendTo(r).data("swatch-color",a.swatches[s]).find(".minicolors-swatch-color").css({backgroundColor:_(i),opacity:i.a}),a.swatches[s]=i;a.inline&&e.parent().addClass("minicolors-inline"),c(e,!1),e.data("minicolors-initialized",!0)}}function a(t){var e=t.parent();t.removeData("minicolors-initialized").removeData("minicolors-settings").removeProp("size").removeClass("minicolors-input"),e.before(t).remove()}function n(t){var e=t.parent(),a=e.find(".minicolors-panel"),n=t.data("minicolors-settings");!t.data("minicolors-initialized")||t.prop("disabled")||e.hasClass("minicolors-inline")||e.hasClass("minicolors-focus")||(r(),e.addClass("minicolors-focus"),a.stop(!0,!0).fadeIn(n.showSpeed,function(){n.show&&n.show.call(t.get(0))}))}function r(){t(".minicolors-focus").each(function(){var e=t(this),a=e.find(".minicolors-input"),n=e.find(".minicolors-panel"),r=a.data("minicolors-settings");n.fadeOut(r.hideSpeed,function(){r.hide&&r.hide.call(a.get(0)),e.removeClass("minicolors-focus")})})}function i(t,e,a){var n,r,i,s,c=t.parents(".minicolors").find(".minicolors-input"),l=c.data("minicolors-settings"),d=t.find("[class$=-picker]"),u=t.offset().left,p=t.offset().top,h=Math.round(e.pageX-u),f=Math.round(e.pageY-p),g=a?l.animationSpeed:0;e.originalEvent.changedTouches&&(h=e.originalEvent.changedTouches[0].pageX-u,f=e.originalEvent.changedTouches[0].pageY-p),0>h&&(h=0),0>f&&(f=0),h>t.width()&&(h=t.width()),f>t.height()&&(f=t.height()),t.parent().is(".minicolors-slider-wheel")&&d.parent().is(".minicolors-grid")&&(n=75-h,r=75-f,i=Math.sqrt(n*n+r*r),s=Math.atan2(r,n),0>s&&(s+=2*Math.PI),i>75&&(i=75,h=75-75*Math.cos(s),f=75-75*Math.sin(s)),h=Math.round(h),f=Math.round(f)),t.is(".minicolors-grid")?d.stop(!0).animate({top:f+"px",left:h+"px"},g,l.animationEasing,function(){o(c,t)}):d.stop(!0).animate({top:f+"px"},g,l.animationEasing,function(){o(c,t)})}function o(t,e){function a(t,e){var a,n;return t.length&&e?(a=t.offset().left,n=t.offset().top,{x:a-e.offset().left+t.outerWidth()/2,y:n-e.offset().top+t.outerHeight()/2}):null}var n,r,i,o,c,d,u,p=t.val(),h=t.attr("data-opacity"),f=t.parent(),g=t.data("minicolors-settings"),v=f.find(".minicolors-input-swatch"),b=f.find(".minicolors-grid"),M=f.find(".minicolors-slider"),y=f.find(".minicolors-opacity-slider"),_=b.find("[class$=-picker]"),A=M.find("[class$=-picker]"),w=y.find("[class$=-picker]"),T=a(_,b),k=a(A,M),C=a(w,y);if(e.is(".minicolors-grid, .minicolors-slider, .minicolors-opacity-slider")){switch(g.control){case"wheel":o=b.width()/2-T.x,c=b.height()/2-T.y,d=Math.sqrt(o*o+c*c),u=Math.atan2(c,o),0>u&&(u+=2*Math.PI),d>75&&(d=75,T.x=69-75*Math.cos(u),T.y=69-75*Math.sin(u)),r=m(d/.75,0,100),n=m(180*u/Math.PI,0,360),i=m(100-Math.floor(k.y*(100/M.height())),0,100),p=L({h:n,s:r,b:i}),M.css("backgroundColor",L({h:n,s:r,b:100}));break;case"saturation":n=m(parseInt(T.x*(360/b.width()),10),0,360),r=m(100-Math.floor(k.y*(100/M.height())),0,100),i=m(100-Math.floor(T.y*(100/b.height())),0,100),p=L({h:n,s:r,b:i}),M.css("backgroundColor",L({h:n,s:100,b:i})),f.find(".minicolors-grid-inner").css("opacity",r/100);break;case"brightness":n=m(parseInt(T.x*(360/b.width()),10),0,360),r=m(100-Math.floor(T.y*(100/b.height())),0,100),i=m(100-Math.floor(k.y*(100/M.height())),0,100),p=L({h:n,s:r,b:i}),M.css("backgroundColor",L({h:n,s:r,b:100})),f.find(".minicolors-grid-inner").css("opacity",1-i/100);break;default:n=m(360-parseInt(k.y*(360/M.height()),10),0,360),r=m(Math.floor(T.x*(100/b.width())),0,100),i=m(100-Math.floor(T.y*(100/b.height())),0,100),p=L({h:n,s:r,b:i}),b.css("backgroundColor",L({h:n,s:100,b:100}))}h=g.opacity?parseFloat(1-C.y/y.height()).toFixed(2):1,s(t,p,h)}else v.find("span").css({backgroundColor:p,opacity:h}),l(t,p,h)}function s(t,e,a){var n,r=t.parent(),i=t.data("minicolors-settings"),o=r.find(".minicolors-input-swatch");i.opacity&&t.attr("data-opacity",a),"rgb"===i.format?(n=v(e)?f(e,!0):T(h(e,!0)),a=""===t.attr("data-opacity")?1:m(parseFloat(t.attr("data-opacity")).toFixed(2),0,1),(isNaN(a)||!i.opacity)&&(a=1),e=t.minicolors("rgbObject").a<=1&&n&&i.opacity?"rgba("+n.r+", "+n.g+", "+n.b+", "+parseFloat(a)+")":"rgb("+n.r+", "+n.g+", "+n.b+")"):(v(e)&&(e=y(e)),e=p(e,i.letterCase)),t.val(e),o.find("span").css({backgroundColor:e,opacity:a}),l(t,e,a)}function c(e,a){var n,r,i,o,s,c,d,u,M,_,w=e.parent(),T=e.data("minicolors-settings"),k=w.find(".minicolors-input-swatch"),C=w.find(".minicolors-grid"),z=w.find(".minicolors-slider"),x=w.find(".minicolors-opacity-slider"),S=C.find("[class$=-picker]"),D=z.find("[class$=-picker]"),O=x.find("[class$=-picker]");switch(v(e.val())?(n=y(e.val()),s=m(parseFloat(b(e.val())).toFixed(2),0,1),s&&e.attr("data-opacity",s)):n=p(h(e.val(),!0),T.letterCase),n||(n=p(g(T.defaultValue,!0),T.letterCase)),r=A(n),o=T.keywords?t.map(T.keywords.split(","),function(e){return t.trim(e.toLowerCase())}):[],c=""!==e.val()&&t.inArray(e.val().toLowerCase(),o)>-1?p(e.val()):v(e.val())?f(e.val()):n,a||e.val(c),T.opacity&&(i=""===e.attr("data-opacity")?1:m(parseFloat(e.attr("data-opacity")).toFixed(2),0,1),isNaN(i)&&(i=1),e.attr("data-opacity",i),k.find("span").css("opacity",i),u=m(x.height()-x.height()*i,0,x.height()),O.css("top",u+"px")),"transparent"===e.val().toLowerCase()&&k.find("span").css("opacity",0),k.find("span").css("backgroundColor",n),T.control){case"wheel":M=m(Math.ceil(.75*r.s),0,C.height()/2),_=r.h*Math.PI/180,d=m(75-Math.cos(_)*M,0,C.width()),u=m(75-Math.sin(_)*M,0,C.height()),S.css({top:u+"px",left:d+"px"}),u=150-r.b/(100/C.height()),""===n&&(u=0),D.css("top",u+"px"),z.css("backgroundColor",L({h:r.h,s:r.s,b:100}));break;case"saturation":d=m(5*r.h/12,0,150),u=m(C.height()-Math.ceil(r.b/(100/C.height())),0,C.height()),S.css({top:u+"px",left:d+"px"}),u=m(z.height()-r.s*(z.height()/100),0,z.height()),D.css("top",u+"px"),z.css("backgroundColor",L({h:r.h,s:100,b:r.b})),w.find(".minicolors-grid-inner").css("opacity",r.s/100);break;case"brightness":d=m(5*r.h/12,0,150),u=m(C.height()-Math.ceil(r.s/(100/C.height())),0,C.height()),S.css({top:u+"px",left:d+"px"}),u=m(z.height()-r.b*(z.height()/100),0,z.height()),D.css("top",u+"px"),z.css("backgroundColor",L({h:r.h,s:r.s,b:100})),w.find(".minicolors-grid-inner").css("opacity",1-r.b/100);break;default:d=m(Math.ceil(r.s/(100/C.width())),0,C.width()),u=m(C.height()-Math.ceil(r.b/(100/C.height())),0,C.height()),S.css({top:u+"px",left:d+"px"}),u=m(z.height()-r.h/(360/z.height()),0,z.height()),D.css("top",u+"px"),C.css("backgroundColor",L({h:r.h,s:100,b:100}))}e.data("minicolors-initialized")&&l(e,c,i)}function l(t,e,a){var n,r,i,o=t.data("minicolors-settings"),s=t.data("minicolors-lastChange");if(!s||s.value!==e||s.opacity!==a){if(t.data("minicolors-lastChange",{value:e,opacity:a}),o.swatches&&0!==o.swatches.length){for(n=v(e)?f(e,!0):T(e),r=-1,i=0;i<o.swatches.length;++i)if(n.r===o.swatches[i].r&&n.g===o.swatches[i].g&&n.b===o.swatches[i].b&&n.a===o.swatches[i].a){r=i;break}t.parent().find(".minicolors-swatches .minicolors-swatch").removeClass("selected"),-1!==i&&t.parent().find(".minicolors-swatches .minicolors-swatch").eq(i).addClass("selected")}o.change&&(o.changeDelay?(clearTimeout(t.data("minicolors-changeTimeout")),t.data("minicolors-changeTimeout",setTimeout(function(){o.change.call(t.get(0),e,a)},o.changeDelay))):o.change.call(t.get(0),e,a)),t.trigger("change").trigger("input")}}function d(e){var a=h(t(e).val(),!0),n=T(a),r=t(e).attr("data-opacity");return n?(void 0!==r&&t.extend(n,{a:parseFloat(r)}),n):null}function u(e,a){var n=h(t(e).val(),!0),r=T(n),i=t(e).attr("data-opacity");return r?(void 0===i&&(i=1),a?"rgba("+r.r+", "+r.g+", "+r.b+", "+parseFloat(i)+")":"rgb("+r.r+", "+r.g+", "+r.b+")"):null}function p(t,e){return"uppercase"===e?t.toUpperCase():t.toLowerCase()}function h(t,e){return t=t.replace(/^#/g,""),t.match(/^[A-F0-9]{3,6}/gi)?3!==t.length&&6!==t.length?"":(3===t.length&&e&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),"#"+t):""}function f(t,e){var a=t.replace(/[^\d,.]/g,""),n=a.split(",");return n[0]=m(parseInt(n[0],10),0,255),n[1]=m(parseInt(n[1],10),0,255),n[2]=m(parseInt(n[2],10),0,255),n[3]&&(n[3]=m(parseFloat(n[3],10),0,1)),e?{r:n[0],g:n[1],b:n[2],a:n[3]?n[3]:null}:"undefined"!=typeof n[3]&&n[3]<=1?"rgba("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+")":"rgb("+n[0]+", "+n[1]+", "+n[2]+")"}function g(t,e){return v(t)?f(t):h(t,e)}function m(t,e,a){return e>t&&(t=e),t>a&&(t=a),t}function v(t){var e=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);return e&&4===e.length?!0:!1}function b(t){return t=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+(\.\d{1,2})?|\.\d{1,2})[\s+]?/i),t&&6===t.length?t[4]:"1"}function M(t){var e={},a=Math.round(t.h),n=Math.round(255*t.s/100),r=Math.round(255*t.b/100);if(0===n)e.r=e.g=e.b=r;else{var i=r,o=(255-n)*r/255,s=(i-o)*(a%60)/60;360===a&&(a=0),60>a?(e.r=i,e.b=o,e.g=o+s):120>a?(e.g=i,e.b=o,e.r=i-s):180>a?(e.g=i,e.r=o,e.b=o+s):240>a?(e.b=i,e.r=o,e.g=i-s):300>a?(e.b=i,e.g=o,e.r=o+s):360>a?(e.r=i,e.g=o,e.b=i-s):(e.r=0,e.g=0,e.b=0)}return{r:Math.round(e.r),g:Math.round(e.g),b:Math.round(e.b)}}function y(t){return t=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i),t&&4===t.length?"#"+("0"+parseInt(t[1],10).toString(16)).slice(-2)+("0"+parseInt(t[2],10).toString(16)).slice(-2)+("0"+parseInt(t[3],10).toString(16)).slice(-2):""}function _(e){var a=[e.r.toString(16),e.g.toString(16),e.b.toString(16)];return t.each(a,function(t,e){1===e.length&&(a[t]="0"+e)}),"#"+a.join("")}function L(t){return _(M(t))}function A(t){var e=w(T(t));return 0===e.s&&(e.h=360),e}function w(t){var e={h:0,s:0,b:0},a=Math.min(t.r,t.g,t.b),n=Math.max(t.r,t.g,t.b),r=n-a;return e.b=n,e.s=0!==n?255*r/n:0,0!==e.s?t.r===n?e.h=(t.g-t.b)/r:t.g===n?e.h=2+(t.b-t.r)/r:e.h=4+(t.r-t.g)/r:e.h=-1,e.h*=60,e.h<0&&(e.h+=360),e.s*=100/255,e.b*=100/255,e}function T(t){return t=parseInt(t.indexOf("#")>-1?t.substring(1):t,16),{r:t>>16,g:(65280&t)>>8,b:255&t}}t.minicolors={defaults:{animationSpeed:50,animationEasing:"swing",change:null,changeDelay:0,control:"hue",dataUris:!0,defaultValue:"",format:"hex",hide:null,hideSpeed:100,inline:!1,keywords:"",letterCase:"lowercase",opacity:!1,position:"bottom left",show:null,showSpeed:100,theme:"default",swatches:[]}},t.extend(t.fn,{minicolors:function(i,o){switch(i){case"destroy":return t(this).each(function(){a(t(this))}),t(this);case"hide":return r(),t(this);case"opacity":return void 0===o?t(this).attr("data-opacity"):(t(this).each(function(){c(t(this).attr("data-opacity",o))}),t(this));case"rgbObject":return d(t(this),"rgbaObject"===i);case"rgbString":case"rgbaString":return u(t(this),"rgbaString"===i);case"settings":return void 0===o?t(this).data("minicolors-settings"):(t(this).each(function(){var e=t(this).data("minicolors-settings")||{};a(t(this)),t(this).minicolors(t.extend(!0,e,o))}),t(this));case"show":return n(t(this).eq(0)),t(this);case"value":return void 0===o?t(this).val():(t(this).each(function(){"object"==typeof o?(o.opacity&&t(this).attr("data-opacity",m(o.opacity,0,1)),o.color&&t(this).val(o.color)):t(this).val(o),c(t(this))}),t(this));default:return"create"!==i&&(o=i),t(this).each(function(){e(t(this),o)}),t(this)}}}),t(document).on("mousedown.minicolors touchstart.minicolors",function(e){t(e.target).parents().add(e.target).hasClass("minicolors")||r()}).on("mousedown.minicolors touchstart.minicolors",".minicolors-grid, .minicolors-slider, .minicolors-opacity-slider",function(e){var a=t(this);e.preventDefault(),t(document).data("minicolors-target",a),i(a,e,!0)}).on("mousemove.minicolors touchmove.minicolors",function(e){var a=t(document).data("minicolors-target");a&&i(a,e)}).on("mouseup.minicolors touchend.minicolors",function(){t(this).removeData("minicolors-target")}).on("click.minicolors",".minicolors-swatches li",function(e){e.preventDefault();var a=t(this),n=a.parents(".minicolors").find(".minicolors-input"),r=a.data("swatch-color");s(n,r,b(r)),c(n)}).on("mousedown.minicolors touchstart.minicolors",".minicolors-input-swatch",function(e){var a=t(this).parent().find(".minicolors-input");e.preventDefault(),n(a)}).on("focus.minicolors",".minicolors-input",function(){var e=t(this);e.data("minicolors-initialized")&&n(e)}).on("blur.minicolors",".minicolors-input",function(){var e,a,n,r,i,o=t(this),s=o.data("minicolors-settings");o.data("minicolors-initialized")&&(e=s.keywords?t.map(s.keywords.split(","),function(e){return t.trim(e.toLowerCase())}):[],""!==o.val()&&t.inArray(o.val().toLowerCase(),e)>-1?i=o.val():(v(o.val())?n=f(o.val(),!0):(a=h(o.val(),!0),n=a?T(a):null),i=null===n?s.defaultValue:"rgb"===s.format?f(s.opacity?"rgba("+n.r+","+n.g+","+n.b+","+o.attr("data-opacity")+")":"rgb("+n.r+","+n.g+","+n.b+")"):_(n)),r=s.opacity?o.attr("data-opacity"):1,"transparent"===i.toLowerCase()&&(r=0),o.closest(".minicolors").find(".minicolors-input-swatch > span").css("opacity",r),o.val(i),""===o.val()&&o.val(g(s.defaultValue,!0)),o.val(p(o.val(),s.letterCase)))}).on("keydown.minicolors",".minicolors-input",function(e){var a=t(this);if(a.data("minicolors-initialized"))switch(e.keyCode){case 9:r();break;case 13:case 27:r(),a.blur()}}).on("keyup.minicolors",".minicolors-input",function(){var e=t(this);e.data("minicolors-initialized")&&c(e,!0)}).on("paste.minicolors",".minicolors-input",function(){var e=t(this);e.data("minicolors-initialized")&&setTimeout(function(){c(e,!0)},1)})})}),P.when("A","a-checkbox","ac-utils","ac-string-utils","ac-alerts-manager").register("ac-sitestripe",function(t,e,a,n,r){var i=t.$,o="/home/account/sitestripe/status/update",s="/home/account/sitestripe/option/update",c=function(t,e,a,o){i("#ac-ss-status-container").empty().append(t),r.showAlert(r.getFormattedAlert("success",n.getString("sitestripe-status-success")),{reset:!0})},l=function(t,e,a,n){},d=function(t){r.removeAllAlerts();var e={url:o,type:"POST",contentType:"application/json",data:{status:t}},n={showMask:!1},i={};a.ajax(e,c,l,i,n)},u=function(t,e,a,i){r.showAlert(r.getFormattedAlert("success",n.getString("sitestripe-option-success")),{reset:!0})},p=function(t,e,a,n){},h=function(t,e){r.removeAllAlerts();var n={url:s,type:"POST",contentType:"application/json",data:{option:t,status:e}},i={showMask:!0},o={};a.ajax(n,u,p,o,i)},f=function(t){d(t.data.action)},g=function(t){var a=t.data,n=e("#ac-ss-option-key-"+a.value),r=n.isChecked()?"enable":"disable";h(a.value,r)},m=function(t){var e=t.switchState.isOn?"enable":"disable";d(e)};t.declarative("ac-sitestripe-action","click",f),t.declarative("ac-sitestripe-option-action","change",g),t.on("a:switch:sitestripe-toggle:on",m),t.on("a:switch:sitestripe-toggle:off",m)}),P.when("A","ac-carousel","ac-app-config","ac-utils","ac-topsellers","a-dropdown").register("ac-productlinks-bestsellers",function(t,e,a,n,r,i){var o=t.$,s={init:function(){this.initEvents(),e.initializeAll()},initEvents:function(){t.declarative("ac-bestsellers-filterby-selection","change",o.proxy(this.onFilterChange,s))},loadTopSellers:function(t){if(t&&t.length){var e=t.find('[data-type="ac-bestsellers"]'),a=e.data()||{};a.params={},a.container=e,a.selectElm=t.find("select"),a.successCb=o.proxy(this.handleTopsellerSuccess,s),r.loadTopSellers(a)}},isCategoryResponseLoaded:!0,onFilterChange:function(t){var e=i.getSelect(t.$target),a=e.val(),n=t.$target.closest(".ac-bestsellers").find('[data-type="ac-bestsellers"]');if(a===this.selected_category)return!1;var c=n.data();c.params={},c.container=n,c.params={filterby:a},c.selectElm=e,c.successCb=o.proxy(this.handleTopsellerSuccess,s),r.loadTopSellers(c)},handleTopsellerSuccess:function(t,e,a,n){this.selected_category=t.selected_category,i.getSelect(n.selectElm).setValue(this.selected_category)}};return s.init(),{loadTopSellers:o.proxy(s.loadTopSellers,s)}}),P.when("A","ac-ads-code-container","ac-utils","ac-app-config","ac-link-id","3p-jquery-minicolors","ac-string-utils").register("ac-productlinks-customize-link",function(t,e,a,n,r,i,o){var s=t.$,c=n.getConfig("Associates.isNPAllowed"),l={init:function(){this.initVariables(),this.initEvents(),t.trigger("ac-productlinks-generate-ad-code",this.type),this.initColorPickers()},initVariables:function(){this.customizeContainerRef=s("#ac-productlinks-customize-details-tab .ac-tab-content-wrapper"),this.type=s("#ac-productlinks-customize-details-tab .ac-tab-content:visible").data("type"),this.defaultAdcodeValues={openInNewWindow:"false",showServedBorder:"false",useLargeServedImage:"false"},this.staticTextLinkDestination=n.getConfig("Associates.staticTextLinkDestination"),this.staticImgLinkDestination=this.staticTextLinkDestination,this.staticImageSizes=n.getConfig("Associates.staticImageSizes")||[],this.bannerPreviewContainer=s("#ac-productlinks-rotating-banner-preview-container"),this.imageSizes=[];for(var t=0;t<this.staticImageSizes.length;t++)this.imageSizes[this.staticImageSizes[t].value]=this.staticImageSizes[t].size},initEvents:function(){t.declarative("ac-adcode-params-change","keyup change",s.proxy(this.onAdcodeInputChange,l)),t.on("ac-productlinks-generate-ad-code",s.proxy(this.generateAdCode,l)),t.declarative("ac-tab-switch","click",s.proxy(this.handleTabSwitch,l)),t.on("ac-productlinks-generate-ad-code",a.debounce(s.proxy(this.savePreferences,l),5e3)),t.declarative("ac-productlinks-rotating-banner-nav-click","click",s.proxy(this.handleNavActions,l)),t.declarative("ac-productlinks-reset-colors","click",s.proxy(this.resetColors,l)),this.bannerPreviewContainer.delegate(".start-over","click",s.proxy(this.showFirstElement,l)),this.customizeContainerRef.delegate("form","submit",s.proxy(this.disableFormSubmits,l))},disableFormSubmits:function(){return!1},handleNavActions:function(t){var e=(t.$target.closest(".ac-productlinks-rotating-banner-preview-container"),this.bannerPreviewContainer.find("li:visible")),a=e.next(),n=e.prev();t.$currentTarget.find(".nav");"prev"===t.data.type?this.showPrev(a,n,e,this.bannerPreviewContainer,t.data):this.showNext(a,n,e,this.bannerPreviewContainer,t.data)},showFirstElement:function(){var t=this.bannerPreviewContainer.find("li:visible"),e=this.bannerPreviewContainer.find("li").first(),a=t.next();this.showPrev(a,e,t,this.bannerPreviewContainer,{total:this.bannerPreviewContainer.find("li").length})},showNext:function(t,e,a,n,r){var i=n.find(".next");if(t.is("li")){i.removeClass("disabled"),n.find(".prev").removeClass("disabled"),t.show();var s=o.getString("productlinks-image-footer-info",{total:r.total,current:t.index()+1,startOvervisibilityCls:"ac-display-inline-block"});n.find(".nav-footer").html(s),a.hide(),t.index()+1===r.total&&i.addClass("disabled"),this.generateAdCode()}else i.addClass("disabled"),n.find(".prev").removeClass("disabled")},showPrev:function(t,e,a,n,r){var i=n.find(".prev");if(e.is("li")){i.removeClass("disabled"),e.show();var s=o.getString("productlinks-image-footer-info",{total:r.total,current:e.index()+1,startOvervisibilityCls:0===e.index()?"ac-hidden":"ac-display-inline-block"});n.find(".nav-footer").html(s),n.find(".next").removeClass("disabled"),a.hide(),0===e.index()&&i.addClass("disabled"),this.generateAdCode()}else i.addClass("disabled"),n.find(".next").removeClass("disabled")},currentAdcodeParams:null,getFormValues:function(t,e){var n=s("#ac-productlinks-ad-code-form-"+this.type),r=n.serializeArray(),i=this;e&&e.length?s.each(e,function(t,e){r.push(e)}):n.data("linkcode")&&r.push({name:"linkCode",value:n.data("linkcode")});var o={};return s.each(r,function(e,n){var r=n.value?n.value.replace("#",""):n.value;r=a.escapeHtml(r),o[n.name]=r,t&&i[n.name]&&(o[n.name]=i[n.name][r])}),"text_image"===this.type&&(o=s.extend({},this.defaultAdcodeValues,o)),this.currentAdcodeParams=o,o},savePreferences:function(){if(!a.isSuperUser()){var t={contentType:"application/json",url:s("#ac-productlinks-customize").data("url"),type:"POST",data:{preferences:this.getFormValues()},timeout:n.getConfig("ajax_timeout")},e={showMask:!1},r=s.proxy(this.preferenceSaveSuccess,l),i=s.proxy(this.preferenceSaveError,l);a.ajax(t,r,i,{},e)}},preferenceSaveSuccess:function(){},preferenceSaveError:function(){},initColorPickers:function(){var t=this;jQuery(".ac-colorpicker").minicolors({position:"bottom left",change:function(e,a){e&&t.onAdcodeInputChange({})}})},resetColors:function(){jQuery("#ac-productlinks-ad-code-form-"+this.type).find(".ac-colorpicker").each(function(){jQuery(this).minicolors("value",jQuery(this).data("default_value"))})},handleTabSwitch:function(e){var a=e.data;e.$currentTarget.find("li").hasClass("active")||e.$currentTarget.data("ad-code-generated")||(e.$currentTarget.data("ad-code-generated",!0),t.trigger("ac-productlinks-generate-ad-code",a.type))},onAdcodeInputChange:function(e){var a=e.data,n=[];a&&a.linkCode&&n.push({name:"linkCode",value:a.linkCode[e.$target.val()]}),this.type=s("#ac-productlinks-customize-details-tab .ac-tab-content:visible").data("type"),t.trigger("ac-productlinks-generate-ad-code","",n)},handleLegacyProductPreview:function(t,e){var a="";return t.showServedBorder="true"===t.showServedBorder?"000000":t.servedBGColor,t.openInNewWindow="true"===t.openInNewWindow?"_blank":"_top",a+="true"===t.useLargeServedImage?"IS2=1":"IS1=1",t.servedPriceOpts&&(a=a+"&"+t.servedPriceOpts+"=1"),t.additionalParams=a,t},getFilledTemplate:function(t){var e=s("#ac-productlinks-"+this.type+"-tab-script-template"),n=e.val(),r=this;return c||(t=this.handleLegacyProductPreview(t,n)),s.each(t,function(t,i){if(n=n.replace("{{"+t+"}}",i),"linkCode"===t){var o=r.getLinkId(i,e.data("linkIdParams"));n=n.replace("{{"+o.name+"}}",a.escapeHtml(o.value.replace("#","")))}}),n},generateAdCode:function(t,e){t&&(this.type=t);var a=this.getFilledTemplate(this.getFormValues(!1,e));this.updateAdCode(a),this.updatePreview(a)},getLinkId:function(t,e){e=e||{};var i=n.getConfig("Associates.LinkCode"),o={tag:a.getTrackingId(),linkCode:t,toolCreation:i.tool};return o=s.extend(e,o),{name:"link_id",value:r.get(o,{})}},updateAdCode:function(e){t.trigger("ac-ad-code-update",{content:e,id:"ac-productlinks-ad-code-panel-"+this.type})},getSearchType:function(){return s("#ac-productlinks-"+this.type+"-tab-script-template").data("type")},updatePreview:function(t){var e=s("#ac-productlinks-preview-panel-"+this.type),a=this.getSearchType();a&&"asin"!==a?this.updateCarouselPreview(t):e.html(t)},updateCarouselPreview:function(t){var e=this.bannerPreviewContainer.find("li:visible");e.empty();var a=e.data("asin"),n=t.replace("{{asin}}",a);e.html(n),this.updateAdCode(n);var r=this.imageSizes[this.currentAdcodeParams.staticImageSizes],i=s("#ac-productlinks-rotating-banner-preview");i.data("size")!==r&&(i.data("size",r),i.height(r),i.width(r),this.loadAllPreviews(t))},loadAllPreviews:function(t){this.bannerPreviewContainer.find("li.ac-hidden").each(function(e,a){var n=s(a),r=n.data("asin"),i=t.replace("{{asin}}",r);n.html(i)})}};s("#ac-productlinks-customize")&&s("#ac-productlinks-customize").length&&l.init()}),P.when("A","ac-productlinks-bestsellers").register("ac-productlinks",function(t,e){var a=t.$;e.loadTopSellers(a("#ac-productlinks-bestsellers"))}),P.when("A","ac-quicklink-search-interface","ac-utils","ac-app-config","a-dropdown","ac-history-manager","ac-string-utils").register("ac-productlinks-search-product",function(t,e,a,n,r,i,o){var s=t.$,c="_NONE",l={init:function(){this.initVariable(),this.initEvents(),this.options&&this.isSearch&&this.updateSearchResults(i.getState())},initVariable:function(){this.searchContainer=s("#ac-productlinks-search-result"),this.mainContainer=s("#ac-productlinks-search-home"),this.searchField=s("#search-product-field"),this.searchForm=s("#ac-productlinks-search-form"),this.sortByForm=s("#ac-productlinks-sortby-form"),this.subcategoryWrapper=s("#sub-category-selection"),this.subcategoryComp=r.getSelect("ac-productlinks-subcategory-select-comp"),this.categoryComp=r.getSelect("ac-productlinks-category-select-comp"),this.searchProductStep=s("#search-product-step"),this.selectProductStep=s("#select-product-step"),this.options=this.getFormValues(this.searchForm),this.isSearch=this.mainContainer.data("isSearch")},initEvents:function(){t.declarative("ac-productlink-search-product-btn","click",s.proxy(this.handleSearchAction,l)),t.declarative("ac-productlinks-category-selection","change",s.proxy(this.handleCategorySelection,l)),t.declarative("ac-productlinks-sortby-selection","change",s.proxy(this.onSortbySelection,l)),t.on("ac-historychange",s.proxy(this.updateSearchResults,l))},updateSearchResults:function(e){var a=e.data;this.options=t.objectIsEmpty(a)?this.options:a,!t.objectIsEmpty(a)||this.isSearch?(this.searchContainer.show(),this.loadSearchResults(),this.searchProductStep.hide(),this.selectProductStep.show()):(this.searchProductStep.show(),this.selectProductStep.hide(),this.searchContainer.empty().hide(),this.mainContainer.find(".ac-productlinks-bestsellers").show(),this.resetCategories())},resetCategories:function(){this.subcategoryComp?this.subcategoryComp.removeOptions():"",this.categoryComp?this.categoryComp.setValue("all"):""},getParameters:function(t){return this.params={},this.params.url=this.mainContainer.data("url"),this.params.data=this.options,this.params},getFormValues:function(t,e){var n=t.serializeArray(),r={},i=!0;return s.each(n,function(t,n){i="undefined"!=typeof e?n.value!==e:!0,i&&(r[n.name]=a.escapeHtml(n.value))}),r},updatePageState:function(t){i.setState(t,this.getUrlParams(t))},getUrlParams:function(t){var e=s("#ac-productlinks-search-home").data("urlParams");return delete e.controller,delete e.action,s.extend(e,t)},onSortbySelection:function(){if(this.triggerSortBy){var t=this.getFormValues(s("#ac-productlinks-sortby-form"));this.updatePageState(t)}else this.triggerSortBy=!0},handleSearchAction:function(t){t&&t.$event.preventDefault();var e=this.getFormValues(this.searchForm,c);this.updatePageState(e)},handleCategorySelection:function(t){if(!this.historyUpdates){var e={};if(this.categoryComp=r.getSelect(t.$target),e.category=this.categoryComp.val(),"all"===e.category)return this.subcategoryWrapper.hide(),void this.subcategoryComp.setValue("");e.url=t.data.url,this.loadSubCategories(e)}},loadSubCategories:function(t){var e=t?t:{},r={url:e.url,type:e.type?e.type:"GET",data:t,timeout:n.getConfig("ajax_timeout")},i={showMask:!1},o=s.proxy(l.handleSubcategotySuccess,l),c=s.proxy(l.handleSubcategotyFailure,l),d={};a.ajax(r,o,c,d,i)},handleSubcategotySuccess:function(t){if(t){var e=this.getSubCategoryOptions(t);e.length?(this.subcategoryComp.removeOptions().addOptions(e),this.subcategoryComp.setValue(""),this.subcategoryWrapper.show()):(this.subcategoryComp.removeOptions(),this.subcategoryWrapper.hide())}},getSubCategoryOptions:function(e){var a=[];t.objectIsEmpty(e)||a.push({text:o.getString("subcategory-none-option"),value:c});for(var n in e)if(e.hasOwnProperty(n)){var r={};r.text=n,r.value=e[n],a.push(r)}return a},handleSubcategotyFailure:function(){},loadSearchResults:function(){var t=this.getParameters(),a=s.proxy(this.handleSearchSuccess,l),n=s.proxy(this.handleSearchFailure,l),t={succesCb:a,errorCb:n,isLazyLoad:!0,append:!1,ajaxOptions:t,searchResultContainerId:"ac-productlinks-search-result"};e.loadSearchresult(t)},scrollToview:function(){var t=this.mainContainer.offset();s("html, body").animate({scrollTop:t.top,scrollLeft:t.left})},updatePageElements:function(){var e=i.getState().data;t.objectIsEmpty(e)&&(e=this.options),this.historyUpdates=!0,this.mainContainer.find(".ac-productlinks-bestsellers").hide(),this.searchField.val(e.keywords),this.subcategoryComp&&this.subcategoryComp.setValue(e.subcategory?e.subcategory:""),this.categoryComp&&this.categoryComp.setValue(e.category?e.category:"all"),this.historyUpdates=!1},handleSearchSuccess:function(t,e,a,n){n.append||(this.triggerSortBy=!1,s("#ac-productlinks-sortby").trigger("change")),t.sub_categories&&this.handleSubcategotySuccess(t.sub_categories),this.updatePageElements()},handleSearchFailure:function(t,e,a,n){}};s("#ac-productlinks-search-home")&&s("#ac-productlinks-search-home").length&&l.init()});